# API REST para Sensores IoT<br><br>## Descripción<br>Este proyecto es una API REST desarrollada para la asignatura de **Ecosistemas Móviles y Distribuidos (EMD)**. La API permite gestionar sensores IoT y sus lecturas, proporcionando funcionalidades CRUD para ambos. Está diseñada para ser utilizada en aplicaciones distribuidas que requieren la recopilación y análisis de datos de sensores.<br><br>## Características<br>- Gestión de sensores (crear, leer, actualizar y eliminar).<br>- Gestión de lecturas de sensores (crear, leer, eliminar).<br>- Filtrado de lecturas por rango de fechas.<br>- Sanitización de entradas para prevenir inyecciones en MongoDB.<br>- Scripts para importar y exportar datos de la base de datos.<br><br>## Tecnologías utilizadas<br>- **Node.js**: Entorno de ejecución.<br>- **Express.js**: Framework para la creación de la API REST.<br>- **MongoDB**: Base de datos NoSQL.<br>- **Mongoose**: ODM para MongoDB.<br>- **Moment.js**: Manejo de fechas.<br>- **Mongo-sanitize**: Protección contra inyecciones.<br><br>## Estructura del proyecto<br>```. <br>├── config/             # Configuración de la base de datos<br>├── controllers/        # Lógica de negocio de la API<br>├── models/             # Modelos de datos (Mongoose)<br>├── resources/          # Recursos adicionales y datos de ejemplo<br>├── routes/             # Definición de rutas de la API<br>├── server.js           # Punto de entrada de la aplicación<br>├── package.json        # Dependencias y metadatos del proyecto<br>└── README.md           # Documentación del proyecto<br>```<br><br>## Instalación<br>1. Clona el repositorio:<br>```bash<br>git clone https://github.com/tu-usuario/API_EMD.git<br>cd API_EMD<br>```<br><br>2. Instala las dependencias:<br>```bash<br>npm install<br>```<br><br>3. Configura la base de datos:<br>- Edita el archivo `.env` con las credenciales de tu base de datos MongoDB:<br>```<br>MONGO_CREDENTIALS=mongodb://TU_NOMBRE:TUCONTRASEÑA@localhost:27017/sensores?authSource=admin<br>PORT=3000<br>```<br><br>4. Inicia el servidor:<br>```bash<br>node server.js<br>```<br><br>## Endpoints<br><br>### Sensores<br>| Método | URL             | Descripción                       |<br>|--------|-----------------|-----------------------------------|<br>| GET    | `/sensors`      | Obtener todos los sensores        |<br>| GET    | `/sensors/:id`  | Obtener un sensor por su ID       |<br>| POST   | `/sensors`      | Crear un nuevo sensor             |<br>| PUT    | `/sensors/:id`  | Actualizar un sensor existente    |<br>| DELETE | `/sensors/:id`  | Eliminar un sensor                |<br><br>### Lecturas<br>| Método | URL                          | Descripción                                |<br>|--------|------------------------------|--------------------------------------------|<br>| GET    | `/readings/:sensorId`        | Obtener todas las lecturas de un sensor    |<br>| GET    | `/readings/time/:sensorId`   | Obtener lecturas por rango de fechas       |<br>| POST   | `/readings`                  | Crear una nueva lectura                    |<br>| DELETE | `/readings/:sensorId`        | Eliminar todas las lecturas de un sensor   |<br><br>## Modelos de datos<br><br>### Sensor<br>```json<br>{<br>  "name": "string",       // Nombre del sensor<br>  "type": "string",       // Tipo de sensor (Temperatura, Humedad, etc.)<br>  "location": "string",   // Ubicación física del sensor<br>  "createdAt": "Date"     // Fecha de creación del registro<br>}<br>```<br><br>### Lectura<br>```json<br>{<br>  "sensorId": "string",   // ID del sensor asociado<br>  "value": "number",      // Valor de la lectura<br>  "unit": "string",       // Unidad de medida (°C, %RH, ppm, etc.)<br>  "timestamp": "Date"     // Fecha/hora de la lectura<br>}<br>```<br><br>## Scripts de utilidad<br><br>### Exportar datos<br>```bash<br>bash resources/export_data.sh<br>```<br>Este script exporta los datos de sensores y lecturas a los archivos `sensors_back.json` y `readings_back.json`.<br><br>### Importar datos<br>```bash<br>bash resources/import_data.sh<br>```<br>Este script importa datos desde los archivos `sensors.json` y `readings.json` a la base de datos.<br><br>## Seguridad<br>La API utiliza el paquete `mongo-sanitize` para proteger contra inyecciones en MongoDB. Además, las credenciales sensibles se almacenan en un archivo `.env` que está excluido del repositorio mediante `.gitignore`.<br><br>## Pruebas<br>Incluye una colección de Postman para probar los endpoints de la API:<br>- Archivo: `resources/API Datos.postman_collection.json`<br><br>## Licencia<br>Este proyecto está licenciado bajo la licencia ISC.<br><br>## Autor<br>Jose Aveleira